[2025-09-03 15:49:07] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 15:49:07] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 15:49:07] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 15:49:07] [INFO] [transactions] Setting home location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 15:49:07] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 15:49:07] [INFO] [transactions] Transaction created: ID 296, Amount: 10000.00, Type: transfer
[2025-09-03 15:49:07] [INFO] [transactions] Risk assessment: Score=0, Triggers=[], Requires OTP=False, Decision=Approve
[2025-09-03 15:49:08] [INFO] [transactions] ML score: 0.5828239235242251, Contribution: 23, Final risk score: 23
[2025-09-03 15:49:08] [INFO] [transactions] Transaction details: ID=296, Client=loay abassi, Type=transfer, Amount=10000.00 DZD, Risk Score=23, Decision=Approve, Triggers=[]
[2025-09-03 15:49:08] [INFO] [transactions] Transaction | ID: 296 | Amount: $10000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 296, "amount": "10000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_23"}
[2025-09-03 15:49:08] [INFO] [transactions] Updating balances for transaction 296
[2025-09-03 15:49:08] [INFO] [transactions] Current balance: 6139862.01, Amount: 10000.00
[2025-09-03 15:49:08] [INFO] [transactions] Transfer (sender): New balance = 6129862.01
[2025-09-03 15:49:08] [WARNING] [transactions] Recipient account 8999999 not found for transfer
[2025-09-03 15:49:08] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 15:49:08] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=85008.6243750000, std_amount=243815.420630280, transaction_count=16
[2025-09-03 15:49:08] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6129862.01 DZD
[2025-09-03 15:49:08] [INFO] [transactions] Low risk transaction completed: ID 296, Risk score: 23
[2025-09-03 15:49:42] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 15:49:42] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 15:49:42] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 15:49:42] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 15:49:42] [INFO] [transactions] Transaction created: ID 297, Amount: 15000.00, Type: transfer
[2025-09-03 15:49:42] [INFO] [transactions] Risk assessment: Score=30, Triggers=['Large transfer: $15000.00 > $10000.0'], Requires OTP=False, Decision=Approve
[2025-09-03 15:49:42] [INFO] [transactions] ML score: 0.5828239235242251, Contribution: 23, Final risk score: 53
[2025-09-03 15:49:42] [INFO] [transactions] Transaction details: ID=297, Client=loay abassi, Type=transfer, Amount=15000.00 DZD, Risk Score=53, Decision=Approve, Triggers=['Large transfer: $15000.00 > $10000.0']
[2025-09-03 15:49:42] [INFO] [transactions] Transaction | ID: 297 | Amount: $15000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 297, "amount": "15000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_53"}
[2025-09-03 15:49:42] [INFO] [transactions] Creating transaction OTP for transaction 297, user abassi.loay@gmail.com
[2025-09-03 15:49:42] [INFO] [transactions] Created transaction OTP 192432 for transaction 297, expires at 2025-09-03 14:59:42.165433+00:00
[2025-09-03 15:49:43] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 297
[2025-09-03 15:49:43] [INFO] [transactions] Transaction requires OTP verification: ID 297, Risk score: 53, Triggers: 1, ML score: 0.583
[2025-09-03 15:50:48] [INFO] [transactions] Verifying transaction OTP for transaction 297, user abassi.loay@gmail.com
[2025-09-03 15:50:48] [INFO] [transactions] Transaction OTP verified successfully for transaction 297
[2025-09-03 15:50:48] [INFO] [transactions] Updating balances for transaction 297
[2025-09-03 15:50:48] [INFO] [transactions] Current balance: 6129862.01, Amount: 15000.00
[2025-09-03 15:50:48] [INFO] [transactions] Transfer (sender): New balance = 6114862.01
[2025-09-03 15:50:48] [WARNING] [transactions] Recipient account 8999999 not found for transfer
[2025-09-03 15:50:48] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 15:50:48] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=80596.3523529412, std_amount=237193.230320742, transaction_count=17
[2025-09-03 15:50:48] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6114862.01 DZD
[2025-09-03 15:50:48] [INFO] [transactions] Transaction 297 completed after OTP verification
[2025-09-03 15:53:16] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 15:53:16] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 15:53:16] [INFO] [transactions] Location validation passed: (36.75232733795116, 10.109473133213124)
[2025-09-03 15:53:16] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.75232733795116, 10.109473133213124)
[2025-09-03 15:53:16] [INFO] [transactions] Transaction created: ID 298, Amount: 1000.00, Type: transfer
[2025-09-03 15:53:16] [INFO] [transactions] Risk assessment: Score=0, Triggers=[], Requires OTP=False, Decision=Approve
[2025-09-03 15:53:16] [INFO] [transactions] ML score: 0.4687549424283146, Contribution: 18, Final risk score: 18
[2025-09-03 15:53:16] [INFO] [transactions] Transaction details: ID=298, Client=loay abassi, Type=transfer, Amount=1000.00 DZD, Risk Score=18, Decision=Approve, Triggers=[]
[2025-09-03 15:53:16] [INFO] [transactions] Transaction | ID: 298 | Amount: $1000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 298, "amount": "1000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_18"}
[2025-09-03 15:53:16] [INFO] [transactions] Updating balances for transaction 298
[2025-09-03 15:53:16] [INFO] [transactions] Current balance: 6114862.01, Amount: 1000.00
[2025-09-03 15:53:16] [INFO] [transactions] Transfer (sender): New balance = 6113862.01
[2025-09-03 15:53:16] [WARNING] [transactions] Recipient account 5555555 not found for transfer
[2025-09-03 15:53:16] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 15:53:16] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=76952.1105555556, std_amount=230999.581185626, transaction_count=18
[2025-09-03 15:53:16] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6113862.01 DZD
[2025-09-03 15:53:16] [INFO] [transactions] Low risk transaction completed: ID 298, Risk score: 18
[2025-09-03 16:00:18] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 16:00:18] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 16:00:18] [WARNING] [transactions] Transaction blocked: Invalid location coordinates (0.0, 0.0) for user abassi.loay@gmail.com
[2025-09-03 16:00:18] [INFO] [transactions] Transaction | ID: 0 | Amount: $1000.00 | Type: transfer | Status: REJECTED_INVALID_LOCATION | Data: {"transaction_id": 0, "amount": "1000.00", "transaction_type": "transfer", "user_id": 61, "status": "REJECTED_INVALID_LOCATION", "risk_level": null}
[2025-09-03 16:00:37] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 16:00:37] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 16:00:37] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 16:00:37] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 16:00:37] [INFO] [transactions] Transaction created: ID 299, Amount: 999.97, Type: transfer
[2025-09-03 16:00:37] [INFO] [transactions] Risk assessment: Score=25, Triggers=['High frequency: 6 transactions in 2.0 hour(s)'], Requires OTP=False, Decision=Approve
[2025-09-03 16:00:37] [INFO] [transactions] ML score: 0.480161714929228, Contribution: 19, Final risk score: 44
[2025-09-03 16:00:37] [INFO] [transactions] Transaction details: ID=299, Client=loay abassi, Type=transfer, Amount=999.97 DZD, Risk Score=44, Decision=Approve, Triggers=['High frequency: 6 transactions in 2.0 hour(s)']
[2025-09-03 16:00:37] [INFO] [transactions] Transaction | ID: 299 | Amount: $999.97 | Type: transfer | Status: CREATED | Data: {"transaction_id": 299, "amount": "999.97", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_44"}
[2025-09-03 16:00:37] [INFO] [transactions] Creating transaction OTP for transaction 299, user abassi.loay@gmail.com
[2025-09-03 16:00:37] [INFO] [transactions] Created transaction OTP 700685 for transaction 299, expires at 2025-09-03 15:10:37.191440+00:00
[2025-09-03 16:00:40] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 299
[2025-09-03 16:00:40] [INFO] [transactions] Transaction requires OTP verification: ID 299, Risk score: 44, Triggers: 1, ML score: 0.480
[2025-09-03 16:01:01] [INFO] [transactions] Verifying transaction OTP for transaction 299, user abassi.loay@gmail.com
[2025-09-03 16:01:01] [INFO] [transactions] Transaction OTP verified successfully for transaction 299
[2025-09-03 16:01:01] [INFO] [transactions] Updating balances for transaction 299
[2025-09-03 16:01:01] [INFO] [transactions] Current balance: 6113862.01, Amount: 999.97
[2025-09-03 16:01:01] [INFO] [transactions] Transfer (sender): New balance = 6112862.04
[2025-09-03 16:01:01] [WARNING] [transactions] Recipient account 555555 not found for transfer
[2025-09-03 16:01:01] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 16:01:01] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=72954.6310526316, std_amount=225477.227609110, transaction_count=19
[2025-09-03 16:01:01] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6112862.04 DZD
[2025-09-03 16:01:01] [INFO] [transactions] Transaction 299 completed after OTP verification
[2025-09-03 17:08:45] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:08:45] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:08:45] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 17:08:45] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 17:08:45] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.837786, 10.295706), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 17:08:45] [ERROR] [transactions] Error creating transaction: cannot access local variable 'requires_otp' where it is not associated with a value
[2025-09-03 17:09:45] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:09:45] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:09:45] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 17:09:45] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 17:09:45] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.837786, 10.295706), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 17:09:45] [ERROR] [transactions] Error creating transaction: cannot access local variable 'requires_otp' where it is not associated with a value
[2025-09-03 17:25:37] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:25:37] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:25:37] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 17:25:37] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 17:25:37] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.837786, 10.295706), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 17:25:37] [INFO] [transactions] Transaction created: ID 303, Amount: 500.00, Type: transfer
[2025-09-03 17:25:37] [INFO] [transactions] Risk assessment: Score=25, Triggers=['High frequency: 7 transactions in 2.0 hour(s)'], Requires OTP=False, Decision=Approve
[2025-09-03 17:25:38] [INFO] [transactions] ML score: 0.4816780705349232, Contribution: 19, Final risk score: 44
[2025-09-03 17:25:38] [INFO] [transactions] Transaction details: ID=303, Client=loay abassi, Type=transfer, Amount=500.00 DZD, Risk Score=44, Decision=Approve, Triggers=['High frequency: 7 transactions in 2.0 hour(s)']
[2025-09-03 17:25:38] [INFO] [transactions] Transaction | ID: 303 | Amount: $500.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 303, "amount": "500.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_44"}
[2025-09-03 17:25:38] [INFO] [transactions] OTP decision for transaction 303: Required=True, Reasons=['Business rules triggered: 1']
[2025-09-03 17:25:38] [INFO] [transactions] Creating transaction OTP for transaction 303, user abassi.loay@gmail.com
[2025-09-03 17:25:38] [INFO] [transactions] Created transaction OTP 198108 for transaction 303, expires at 2025-09-03 16:35:38.476290+00:00
[2025-09-03 17:25:40] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 303
[2025-09-03 17:25:40] [INFO] [transactions] Transaction requires OTP verification: ID 303, Risk score: 44, Triggers: 1, ML score: 0.482
[2025-09-03 17:26:11] [INFO] [transactions] Verifying transaction OTP for transaction 303, user abassi.loay@gmail.com
[2025-09-03 17:26:11] [INFO] [transactions] Transaction OTP verified successfully for transaction 303
[2025-09-03 17:26:11] [INFO] [transactions] Updating balances for transaction 303
[2025-09-03 17:26:11] [INFO] [transactions] Current balance: 6112862.04, Amount: 500.00
[2025-09-03 17:26:11] [INFO] [transactions] Transfer (sender): New balance = 6112362.04
[2025-09-03 17:26:11] [WARNING] [transactions] Recipient account 8999999 not found for transfer
[2025-09-03 17:26:11] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 17:26:11] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=69356.8980000000, std_amount=220326.828010158, transaction_count=20
[2025-09-03 17:26:11] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6112362.04 DZD
[2025-09-03 17:26:11] [INFO] [transactions] Transaction 303 completed after OTP verification
[2025-09-03 17:28:02] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:28:02] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:28:02] [INFO] [transactions] Location validation passed: (36.75232184520521, 10.109483199923892)
[2025-09-03 17:28:02] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.75232184520521, 10.109483199923892)
[2025-09-03 17:28:02] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.837786, 10.295706), Current=(36.75232184520521, 10.109483199923892), Last Known=(36.75232184520521, 10.109483199923892)
[2025-09-03 17:28:02] [INFO] [transactions] Transaction created: ID 304, Amount: 500.00, Type: transfer
[2025-09-03 17:28:02] [INFO] [transactions] Risk assessment: Score=25, Triggers=['High frequency: 8 transactions in 2.0 hour(s)'], Requires OTP=False, Decision=Approve
[2025-09-03 17:28:02] [INFO] [transactions] ML score: 0.4660723144215201, Contribution: 18, Final risk score: 43
[2025-09-03 17:28:02] [INFO] [transactions] Transaction details: ID=304, Client=loay abassi, Type=transfer, Amount=500.00 DZD, Risk Score=43, Decision=Approve, Triggers=['High frequency: 8 transactions in 2.0 hour(s)']
[2025-09-03 17:28:02] [INFO] [transactions] Transaction | ID: 304 | Amount: $500.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 304, "amount": "500.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_43"}
[2025-09-03 17:28:02] [INFO] [transactions] OTP decision for transaction 304: Required=True, Reasons=['Business rules triggered: 1']
[2025-09-03 17:28:02] [INFO] [transactions] Creating transaction OTP for transaction 304, user abassi.loay@gmail.com
[2025-09-03 17:28:02] [INFO] [transactions] Created transaction OTP 707581 for transaction 304, expires at 2025-09-03 16:38:02.507815+00:00
[2025-09-03 17:28:04] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 304
[2025-09-03 17:28:04] [INFO] [transactions] Transaction requires OTP verification: ID 304, Risk score: 43, Triggers: 1, ML score: 0.466
[2025-09-03 17:29:18] [INFO] [transactions] Verifying transaction OTP for transaction 304, user abassi.loay@gmail.com
[2025-09-03 17:29:18] [INFO] [transactions] Transaction OTP verified successfully for transaction 304
[2025-09-03 17:29:18] [INFO] [transactions] Updating balances for transaction 304
[2025-09-03 17:29:18] [INFO] [transactions] Current balance: 6112362.04, Amount: 500.00
[2025-09-03 17:29:18] [INFO] [transactions] Transfer (sender): New balance = 6111862.04
[2025-09-03 17:29:18] [WARNING] [transactions] Recipient account 5555555 not found for transfer
[2025-09-03 17:29:18] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 17:29:18] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=66077.9980952381, std_amount=215516.403126276, transaction_count=21
[2025-09-03 17:29:18] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6111862.04 DZD
[2025-09-03 17:29:18] [INFO] [transactions] Transaction 304 completed after OTP verification
[2025-09-03 17:32:20] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:32:20] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:32:20] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 17:32:20] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 17:32:20] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.068951, 10.275907), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 17:32:20] [INFO] [transactions] Transaction created: ID 305, Amount: 5000.00, Type: transfer
[2025-09-03 17:32:20] [INFO] [transactions] Risk assessment: Score=75, Triggers=['High frequency: 9 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home'], Requires OTP=True, Decision=Flag for Review
[2025-09-03 17:32:20] [INFO] [transactions] ML score: 0.5734296907205079, Contribution: 22, Final risk score: 97
[2025-09-03 17:32:20] [INFO] [transactions] Transaction details: ID=305, Client=loay abassi, Type=transfer, Amount=5000.00 DZD, Risk Score=97, Decision=Flag for Review, Triggers=['High frequency: 9 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home']
[2025-09-03 17:32:20] [INFO] [transactions] Transaction | ID: 305 | Amount: $5000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 305, "amount": "5000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_97"}
[2025-09-03 17:32:20] [INFO] [transactions] OTP decision for transaction 305: Required=True, Reasons=['Business rules triggered: 2', 'High risk score: 97', 'Risk engine explicit requirement', 'MANDATORY distance violation']
[2025-09-03 17:32:20] [INFO] [transactions] Creating transaction OTP for transaction 305, user abassi.loay@gmail.com
[2025-09-03 17:32:20] [INFO] [transactions] Created transaction OTP 248480 for transaction 305, expires at 2025-09-03 16:42:20.622269+00:00
[2025-09-03 17:32:23] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 305
[2025-09-03 17:32:23] [INFO] [transactions] Transaction requires OTP verification: ID 305, Risk score: 97, Triggers: 2, ML score: 0.573
[2025-09-03 17:32:23] [ERROR] [transactions] Error creating transaction: UNIQUE constraint failed: transactions_fraudalert.transaction_id
[2025-09-03 17:34:41] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 17:34:41] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 17:34:41] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 17:34:41] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 17:34:41] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.068951, 10.275907), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 17:34:41] [INFO] [transactions] Transaction created: ID 305, Amount: 5000.00, Type: transfer
[2025-09-03 17:34:41] [INFO] [transactions] Risk assessment: Score=75, Triggers=['High frequency: 9 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home'], Requires OTP=True, Decision=Flag for Review
[2025-09-03 17:34:41] [INFO] [transactions] ML score: 0.5734296907205079, Contribution: 22, Final risk score: 97
[2025-09-03 17:34:41] [INFO] [transactions] Transaction details: ID=305, Client=loay abassi, Type=transfer, Amount=5000.00 DZD, Risk Score=97, Decision=Flag for Review, Triggers=['High frequency: 9 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home']
[2025-09-03 17:34:41] [INFO] [transactions] Transaction | ID: 305 | Amount: $5000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 305, "amount": "5000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_97"}
[2025-09-03 17:34:41] [INFO] [transactions] OTP decision for transaction 305: Required=True, Reasons=['Business rules triggered: 2', 'High risk score: 97', 'Risk engine explicit requirement', 'MANDATORY distance violation']
[2025-09-03 17:34:41] [INFO] [transactions] Creating transaction OTP for transaction 305, user abassi.loay@gmail.com
[2025-09-03 17:34:41] [INFO] [transactions] Created transaction OTP 736801 for transaction 305, expires at 2025-09-03 16:44:41.296982+00:00
[2025-09-03 17:34:42] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 305
[2025-09-03 17:34:42] [INFO] [transactions] Transaction requires OTP verification: ID 305, Risk score: 97, Triggers: 2, ML score: 0.573
[2025-09-03 17:34:42] [ERROR] [transactions] Error creating transaction: UNIQUE constraint failed: transactions_fraudalert.transaction_id
[2025-09-03 18:00:36] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 18:00:36] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 18:00:36] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 18:00:36] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 18:00:36] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.068951, 10.275907), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 18:00:36] [INFO] [transactions] Transaction created: ID 305, Amount: 5000.00, Type: transfer
[2025-09-03 18:00:36] [INFO] [transactions] Risk assessment: Score=75, Triggers=['High frequency: 6 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home'], Requires OTP=True, Decision=Flag for Review
[2025-09-03 18:00:37] [INFO] [transactions] ML score: 0.5747112086171662, Contribution: 22, Final risk score: 97
[2025-09-03 18:00:37] [INFO] [transactions] Transaction details: ID=305, Client=loay abassi, Type=transfer, Amount=5000.00 DZD, Risk Score=97, Decision=Flag for Review, Triggers=['High frequency: 6 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home']
[2025-09-03 18:00:37] [INFO] [transactions] Transaction | ID: 305 | Amount: $5000.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 305, "amount": "5000.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_97"}
[2025-09-03 18:00:37] [INFO] [transactions] OTP decision for transaction 305: Required=True, Reasons=['Business rules triggered: 2', 'High risk score: 97', 'Risk engine explicit requirement', 'MANDATORY distance violation']
[2025-09-03 18:00:37] [INFO] [transactions] Creating transaction OTP for transaction 305, user abassi.loay@gmail.com
[2025-09-03 18:00:37] [INFO] [transactions] Created transaction OTP 108557 for transaction 305, expires at 2025-09-03 17:10:37.395008+00:00
[2025-09-03 18:00:39] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 305
[2025-09-03 18:00:39] [INFO] [transactions] Transaction requires OTP verification: ID 305, Risk score: 97, Triggers: 2, ML score: 0.575
[2025-09-03 18:01:09] [INFO] [transactions] Verifying transaction OTP for transaction 305, user abassi.loay@gmail.com
[2025-09-03 18:01:09] [INFO] [transactions] Transaction OTP verified successfully for transaction 305
[2025-09-03 18:01:09] [INFO] [transactions] Updating balances for transaction 305
[2025-09-03 18:01:09] [INFO] [transactions] Current balance: 6112862.04, Amount: 5000.00
[2025-09-03 18:01:09] [INFO] [transactions] Transfer (sender): New balance = 6107862.04
[2025-09-03 18:01:09] [WARNING] [transactions] Recipient account 8999999 not found for transfer
[2025-09-03 18:01:09] [INFO] [transactions] Updating statistics for client loay abassi
[2025-09-03 18:01:09] [INFO] [transactions] Statistics updated for loay abassi: avg_amount=63097.1800000000, std_amount=211003.954949691, transaction_count=22
[2025-09-03 18:01:09] [INFO] [transactions] Balance update completed for client loay abassi. New balance: 6107862.04 DZD
[2025-09-03 18:01:09] [INFO] [transactions] Transaction 305 completed after OTP verification
[2025-09-03 18:01:57] [INFO] [transactions] Creating transaction for user abassi.loay@gmail.com
[2025-09-03 18:01:57] [INFO] [transactions] Client profile found: loay abassi
[2025-09-03 18:01:57] [INFO] [transactions] Location validation passed: (36.8377856, 10.2957056)
[2025-09-03 18:01:57] [INFO] [transactions] Updated last known location for user abassi.loay@gmail.com: (36.8377856, 10.2957056)
[2025-09-03 18:01:57] [INFO] [transactions] Location tracking: User=abassi.loay@gmail.com, Home=(36.068951, 10.275907), Current=(36.8377856, 10.2957056), Last Known=(36.8377856, 10.2957056)
[2025-09-03 18:01:57] [INFO] [transactions] Transaction created: ID 306, Amount: 500.00, Type: transfer
[2025-09-03 18:01:57] [INFO] [transactions] Risk assessment: Score=75, Triggers=['High frequency: 6 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home'], Requires OTP=True, Decision=Flag for Review
[2025-09-03 18:01:57] [INFO] [transactions] ML score: 0.4797494320580509, Contribution: 19, Final risk score: 94
[2025-09-03 18:01:57] [INFO] [transactions] Transaction details: ID=306, Client=loay abassi, Type=transfer, Amount=500.00 DZD, Risk Score=94, Decision=Flag for Review, Triggers=['High frequency: 6 transactions in 2.0 hour(s)', 'Max distance exceeded: 85.51km > 50.0km from home']
[2025-09-03 18:01:57] [INFO] [transactions] Transaction | ID: 306 | Amount: $500.00 | Type: transfer | Status: CREATED | Data: {"transaction_id": 306, "amount": "500.00", "transaction_type": "transfer", "user_id": 61, "status": "CREATED", "risk_level": "Score_94"}
[2025-09-03 18:01:57] [INFO] [transactions] OTP decision for transaction 306: Required=True, Reasons=['Business rules triggered: 2', 'High risk score: 94', 'Risk engine explicit requirement', 'MANDATORY distance violation']
[2025-09-03 18:01:57] [INFO] [transactions] Creating transaction OTP for transaction 306, user abassi.loay@gmail.com
[2025-09-03 18:01:57] [INFO] [transactions] Created transaction OTP 925166 for transaction 306, expires at 2025-09-03 17:11:57.793510+00:00
[2025-09-03 18:01:59] [INFO] [transactions] Transaction OTP created and sent successfully for transaction 306
[2025-09-03 18:01:59] [INFO] [transactions] Transaction requires OTP verification: ID 306, Risk score: 94, Triggers: 2, ML score: 0.480
